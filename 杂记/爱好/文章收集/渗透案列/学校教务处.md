

**原博客地址** 

<https://zhuanlan.zhihu.com/p/40565147>

# 记渗透某学校教务网站修改成绩, 希望各大学校加强管理

[![一匹老黑](https://pic1.zhimg.com/v2-634234d55e3590be93b5459583c2bc6b_xs.jpg)](https://www.zhihu.com/people/yi-pi-lao-hei)

[一匹老黑](https://www.zhihu.com/people/yi-pi-lao-hei)

科技交流家族

13 人赞同了该文章

最近很多大学生又开始忙活了，挂科或者受到处分的很多，不少人开始找黑客帮忙解决问题，殊不知你遇到的，基本都是骗子，大学很多用的是正方教务系统，这个系统漏洞确实也不少，但是真正有技术的同学应该不会挂科，挂科的肯定改不了，所以不用修复这个漏洞也没啥大不了的，闲来无事发一下前年针对某个学校的渗透测试，本人有保留渗透测试的习惯，主要是为了保留思路没事可以看看。

那是在四年前，本来是不想搞这种针对学校的渗透的，但是公司领导的儿子挂科了，耐不住软磨硬泡，花了接近一下午的时间，终于找到漏洞进行修改，就赚了一顿饭。
此漏洞目前不存在了。但是此漏洞还是有不少使用同一模板的网站在使用，以免被其他不法分子利用。为了不必要的麻烦，敏感内容不泄露，图片打码。此思路仅供参考。

大家可以去看看相关新闻，这个是个高危操作，如果不会清理痕迹，很容易被抓，还有就是更改成绩的时候多改几个人的，不然容易被发现。

首先点开他们网站用扫描工具进行扫描。



![img](https://pic3.zhimg.com/80/v2-316c20bff7515e3d5bb11342c2571b06_720w.jpg)



发现有robots.txt，点击查看。



![img](https://pic2.zhimg.com/80/v2-13aba92c711a15b4869f999556052f79_720w.jpg)



得知网站使用PHPCMS v9整站程序，这个程序有个读取任意文件漏洞，这个大家可以自行查询，直接得到某个二级学院的数据库的配置。通过网上下载网站源码，再对语句进行构造，证实可以读取任意文件。当然这个服务器不支持MySQL数据库外连的，得到这个配置没有用。
通过一个错误写入漏洞利用工具秒杀，直接得到webshell。



![img](https://pic1.zhimg.com/80/v2-97d5442fb55ffaa9e3ab38227c2f3d9c_720w.jpg)



挂大马：



![img](https://pic3.zhimg.com/80/v2-e92cc5bd4ed47fd6a7f627bc9001bcae_720w.jpg)



接着，扫描一下发现服务器是Ubuntu12.4的，这个就容易多了，老系统的漏洞还是比较好找的，直接提权，在这个过程中我才发现我错了，这些已知漏洞都是被封堵了，很难搞，看来提权是不行了，继续换个思路。
接着意外收获出现了。发现一个common.inc.php文件，当然就是数据库配置文件了。



![img](https://pic3.zhimg.com/80/v2-9d7dfa56bd7ae11c2dc737c46db61e46_720w.jpg)



然后直接链接数据库看看



![img](https://pic4.zhimg.com/80/v2-9cbf266d3c785ab43368029da07c1c8b_720w.jpg)



执行成功，接着看表名（这个是主站的表格）：



![img](https://pic1.zhimg.com/80/v2-29d444a01db92237b9cb62279d522540_720w.jpg)



之后在服务器上继续找朋友孩子所在二级学院的表，虽说数据库不支持外连，但是我现在已经有本地webshell，连上试试…



![img](https://pic3.zhimg.com/80/v2-516d1eb2cfd75473ab1676dfdb94571e_720w.jpg)



直接搞定，出现了列表。



![img](https://pic2.zhimg.com/80/v2-9e5f8d92b0518c8dcc08babcde7e2179_720w.jpg)



然后通过构造SQL语句进行修改成绩就不说了，这个是关键步骤，会的自然会，不懂的看了也不明白。

通过学号查到所在班级，然后对整个选课表进行修改，修改多人的。防止被发现。

最后就是清除所有痕迹，这个也不说了。

有一点可以确定的是，后来确实没查到，这个是个一百多人的大课，要是小班授课，只有几十人的成绩的话，还是小心点好。毕竟哪几个人挂科老师心里都知道。

顺便再说一句，这个是违法的，2017年网络安全已经立法且完善。大家心理有数，尽量租用外国服务器进行渗透测试，防止被抓。

最后，我希望各个学校看到这篇文章后 检测自己的学校系统是否有这样的漏洞，呼吁各个学校加强对学生信息私密性的保护。