![1599744490585](../../img/1599744490585.png)





#### win32api

![1604901284894](../../img/1604901284894.png)



**Kernel32.dll**  核心模块，进程管理，线程管理

**User32.dll**   window用户界面相关程序接口

**Gdi32.dll**   windows船舰窗口 图形化设备接口



#### 进程的创建过程

```
creat process 创建进程
病毒原理 A进程启动时创建B进程 A进程名字为service的话就是系统进程不可被删除，B进程程序可以是一个文本文件
外挂原理在系统启动线程时注入dll来避免程序中的防御检测
进程创建过程添加antidebug实现反调试
```

![](../img/20201109144832.png)


![1605185580834](../../img/1605185580834.png)

![1605186051495](../../img/1605186051495.png)

![1605185663899](../../img/1605185663899.png)

![1605185956020](../../img/1605185956020.png)

![1605186421586](../../img/1605186421586.png)

![1605185645285](../../img/1605185645285.png)

![1605186535560](../../img/1605186535560.png)

最后一个时dw_flags

![1605185806931](../../img/1605185806931.png)


第一个值为结构体大小

![1605187119319](../../img/1605187119319.png)



![1605187125160](../../img/1605187125160.png)





创建进程一定会创建一个线程

病毒 外挂原理

![](../../img/20201109150224.png)

```
#include<windows.h>
```





#### 句柄表

![1605188233829](../../img/1605188233829.png)

![1605188252105](../../img/1605188252105.png)

#### 字符编码

##### 1.ASCLL编码

一个字节

简体中文下ascll扩展gb2312

就是GBK 两个字节

在不同国家流传会出现乱码

##### 2.UNICODE编码

%ff  类似这样的编码

4个字节

包含全世界的所有文字符号

编码范围：0-0x10f  

问题：unicode 仅仅是个符号集 ，没有解决存储问题

一般默认的存储方式位utf-16

##### 3.utf-8,utf-16

unicode 通过八位或者十六位存储

**utf-16** 编码以16位无符号整数为单位 ，占两个字节

###### utf-8

编码形式

![](/img/20201017125809.png)

###### utf-32

32位为一组

##### 判断文件的存储格式

| utf-8    | EF BB BF |
| -------- | -------- |
| utf-16LE | FF FE    |
| utf-16BE | FE FF    |



![](../../img/20201017130641.png)

#### 2.c语言中的字符

![](../../img/20201017131556.png)

